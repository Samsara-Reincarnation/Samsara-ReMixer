actor PerScanDrone {
	MONSTER
	Health 60
	SeeSound "perscan/sight"
	AttackSound ""
	PainSound ""
	DeathSound "perscan/detonate"
	ActiveSound ""
	Species "Enemies"
	Speed 2.5
	Painchance 0
	Height 56
	Radius 16
	Mass 256
	Obituary "%o was sought and found by a Perimeter Scan Drone."
	Tag "Perimeter Scan Drone"
	Scale 1.15
	DamageFactor "MarathonFusion", 2.0
	DamageFactor "Tesla", 2.0
	DamageFactor "ElectricBolt", 2.0
	DamageFactor "PoisonBolt", 0
    +NOPAIN
	+NOBLOOD
	-COUNTKILL
	+NOGRAVITY
	+FLOAT
    States {
      Spawn:
		BSE6 A 0
		BSE6 A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn1")
		BSE6 A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		BSE6 A 0 A_GiveInventory("AlreadySpawned",1)
	  Spawn1:
	    TNT1 A 0 A_JumpIfHealthLower(65, "Spawn2")
		TNT1 A 0 A_JumpIfHealthLower(35, "Spawn3")
		TNT1 A 0 A_JumpIfHealthLower(10, "Spawn4")
        BSE6 A 5 A_Look
        Loop
	  Spawn2:
		TNT1 A 0 A_JumpIfHealthLower(30, "Spawn3")
		TNT1 A 0 A_JumpIfHealthLower(8, "Spawn4")
		BSE6 B 5 A_Look
	    Loop
	  Spawn3:
		TNT1 A 0 A_JumpIfHealthLower(8, "Spawn4")
		BSE6 C 5 A_Look
	  Loop
	  Spawn4:
		BSE6 D 5 A_Look
	  Loop
      See:
	    TNT1 A 0 A_JumpIfHealthLower(65, "See2")
		TNT1 A 0 A_JumpIfHealthLower(35, "See3")
		TNT1 A 0 A_JumpIfHealthLower(10, "See4")
	    BSE6 A 1 A_Chase
        Loop
      See2:
		TNT1 A 0 A_JumpIfHealthLower(30, "See3")
		TNT1 A 0 A_JumpIfHealthLower(8, "See4")
	    BSE6 B 1 A_Chase
        Loop
      See3:
		TNT1 A 0 A_JumpIfHealthLower(8, "See4")
	    BSE6 C 1 A_Chase
        Loop
      See4:
	    BSE6 D 1 A_Chase
        Loop
	  Melee:
		BSE6 D 1 A_FaceTarget
		BSE6 D 1 A_Die("Suicide")
		Wait
	  Death:
	  XDeath:	  
        TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0) 
        BSE6 E 6 A_NoBlocking
        BSE6 F 6 A_Scream
        BSE6 G 6 A_SpawnItem("PerScanBomb")
        BSE6 H 6
        BSE6 IJK 6
        BSE6 L -1
        Stop
	  Death.Suicide:
        BSE6 E 6 A_NoBlocking
        BSE6 F 6 A_Scream
        BSE6 G 6 A_SpawnItem("PerScanBomb")
        BSE6 H 6
        BSE6 IJK 6
        BSE6 L -1
        Stop		
	  Death.ZorchPistol:
	  Death.Zorch:
	  Death.ZorchKamikaze:
	  Death.PhasingZorch:
	  Death.ZorchSpectral:
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_Stop
		"####" "#" 0 A_NoGravity		
		"####" "#" 0 A_ChangeFlag("DONTGIB",1)
		"####" "#" 0 A_PlaySoundEx("chex/zorch","soundslot5",0,0)
		"####" "#" 3 A_SpawnItem("ZorchEffectTiny")
		"####" "#" 0 A_GiveInventory("EnemyZorched",1)
		"####" "#" 3 A_SetTranslucent(0.9,0)
		"####" "#" 0 A_Scream
		"####" "#" 3 A_SetTranslucent(0.8,0)
		"####" "#" 0 A_NoBlocking
		"####" "#" 3 A_SetTranslucent(0.7,0)
		"####" "#" 3 A_SetTranslucent(0.6,0)
		"####" "#" 3 A_SetTranslucent(0.5,0)
		"####" "#" 3 A_SetTranslucent(0.4,0)
		"####" "#" 3 A_SetTranslucent(0.3,0)
		"####" "#" 3 A_SetTranslucent(0.2,0)
		"####" "#" 3 A_SetTranslucent(0.1,0)
		TNT1 A 1 A_SetTranslucent(1,0)
		TNT1 A -1
		stop
      Death.DukeExplosive:
      Death.DukeDamage:
      Death.DukePistol:
        TNT1 A 0 A_Jump(218,"Death")
        TNT1 A 0 A_GiveToTarget("DukeRobotKill",1)
        goto Death
      Death.MightyBoot:
        TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
        TNT1 A 0 A_Jump(64,"Death")
        TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
        goto Death
      Death.DukeIce:
		"####" "#" 0 A_PlaySound("duke/enemyfreeze")
		"####" "#" 0 A_GiveInventory("FreezethrowerWeakness")
		"####" "#" 0 A_Jump(218,"Ice")
		"####" "#" 0 A_GiveToTarget("DukeKillTaunt",1)
	  Ice:
	  Death.HexenIce:
	  Death.WTMeleeIce:
	  Death.WTRangedIce:
	  Death.Ice:
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_NoBlocking
		"####" "#" 0 A_GenericFreezeDeath
		"####" "#" 70 A_UnsetSolid
		"####" "#" 0 A_IceGuyDie
		"####" "#" 1 A_IceGuyDie
		TNT1 A 0
		stop
      Pain.MightyBoot:
        TNT1 A 0 A_ChangeFlag("NOPAIN",1)
        TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
        BSE6 A 2 A_FaceTarget
        TNT1 A 0 A_Recoil(14)
        TNT1 A 0 A_SpawnDebris("FlemoidGib",1)
        BSE6 A 16 A_Pain
        Goto See
	  Death.Vodoo:
	  Death.VoodooPuff:
	  Death.DynamiteCoop:
	  Death.Dynamite:
	  Death.LifeLeech:
	  Death.CalebNapalm:
	  Death.Shock:	  
	  Death.Vodoo:
	  Death.Tesla:
	  Death.CalebFire:	
	  Death.CalebBullet:	
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		Goto Death
	  Death.EradExplosive:
	  Death.EradNova:
	  Death.EradShock:
	  Death.EradExplosive2:	
	  Death.EradDisc:
	  Death.EradPiercingDart:
	  Death.EradGreenFire:
	  Death.EradCoopGreenFire:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("EleenaDMTaunt1", 1)
		Goto Death
      Death.PSRAPower:
	  Death.PSRAPowerCoop:
	  Death.PSExplosive:
	  Death.PSExplosiveCoop:
	  Death.PSBullet:
	  Death.PSFire:	
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("JonDMTaunt1", 1)
		Goto Death
	  Death.LeonardDamage2:
	  Death.LeonardDamage3:
	  Death.LeonardDamage0:
	  Death.LeonardDamage1:	
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LeonardDMTaunt1", 1)
		Goto Death
	  Death.SWSticky:
      Death.SWStickyCoop:	  
	  Death.SWGrenade:
	  Death.SWNuke:
	  Death.SWRocket:
	  Death.SWRailgun:
	  Death.SWRailgunCoop:
	  Death.SWNukeCoop:
	  Death.SWFlame:
	  Death.SWFlame2:
	  Death.SWFlame2Coop:
	  Death.SWFlame3:	
	  Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		goto Death
	  Death.RottDisintegrate:
		"####" "#" 0 A_ChangeFlag("SOLID", 0)
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_Scream
		"####" "#" 0 A_NoBlocking	
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 0 A_Stop
		"####" "#" 0 A_ChangeFlag("SHOOTABLE",FALSE)
		"####" "#" 0 A_ChangeFlag("NOGRAVITY",TRUE)
		"####" "#" 0 A_ChangeFlag("FLOORCLIP",TRUE)
		"####" "#" 0 A_SpawnItem("RGodModeDeathTiny")
		"####" "#" 3 A_SetTranslucent(0.9,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.8,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.7,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.6,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.5,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.4,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.3,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.2,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.1,0)
		stop
	  Disintegrate:
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_NoBlocking
		"####" "#" 0 A_ChangeFlag("DONTGIB",1)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 0 A_Scream
		"####" "#" 0 A_ChangeFlag("SOLID",FALSE)
		"####" "#" 0 A_ChangeFlag("SHOOTABLE",FALSE)
		"####" "#" 0 A_ChangeFlag("NOGRAVITY",TRUE)
		"####" "#" 0 A_ChangeFlag("FLOORCLIP",TRUE)
		"####" "#" 0 A_Stop
		"####" "#" 3 A_SpawnItem("DisintEffectTiny",0,10)
		"####" "#" 3 A_SetTranslucent(0.9,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.8,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.7,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.6,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.5,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.4,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.3,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.2,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.1,0)
        stop
	  Death.Nuke:
		"####" "#" 0 A_ChangeFlag("SOLID", 0)
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_Scream
		"####" "#" 0 A_NoGravity		
		"####" "#" 0 A_NoBlocking		
		"####" "#" 0 A_SpawnItem("WTNukeDeathTiny")
		"####" "#################" 3 A_Fadeout(0.05)
		stop		
    }
}

Actor PerScanBomb {
	Radius 1
	Height 1
	Speed 0
	+NOCLIP
	PROJECTILE
	States {
		Spawn:
			TNT1 A 0
			Goto Death
		Death:
			BFX1 A 5 Bright
			TNT1 A 0 A_PlaySound("perscan/detonate", 6, 1.0, 0, ATTN_NONE)
			TNT1 A 0 A_Explode(16*random(2, 4), 128)
			BFX1 BCDE 5 Bright
			stop
  }
}

Actor MultiPerScanDrone : PerScanDrone {
	Species "PerScanDrone"
	+THRUSPECIES
}

Actor PerGunnerDrone : PerScanDrone
{
	Health 123
	Obituary "%o was spotted and gunned down by a Perimeter Gunner Drone."
	Tag "Perimeter Gunner Drone"		
    States {
		Spawn:
			BS32 A 0
			BS32 A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn1")
			BS32 A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
			BS32 A 0 A_GiveInventory("AlreadySpawned",1)		
		Spawn1:
			BS32 A 5 A_Look
			Loop	
		See:
			BS32 A 5 A_Chase
			Loop
		Melee:
			BS32 A 5 
			Goto See
		Missile:
			TNT1 A 0 A_ChangeFlag(NOPAIN,0)
			BS32 A 5 A_FaceTarget
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			TNT1 A 0 A_JumpIfCloser (108, "Bullet1")
			TNT1 A 0 A_JumpIfCloser (236, "Bullet2")
			TNT1 A 0 A_JumpIfCloser (364, "Bullet3")
			TNT1 A 0 A_JumpIfCloser (492, "Bullet4")
			TNT1 A 0 A_JumpIfCloser (620, "Bullet5")
			TNT1 A 0 A_JumpIfCloser (748, "Bullet6")
			Goto Bullet7
		Bullet1:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD1",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD1",32,0,random(-6,6),8)
			Goto MissileEnd
		Bullet2:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD2",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD2",32,0,random(-6,6),8)
			Goto MissileEnd
		Bullet3:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD3",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD3",32,0,random(-6,6),8)
			Goto MissileEnd
		Bullet4:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD4",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD4",32,0,random(-6,6),8)
			Goto MissileEnd
		Bullet5:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD5",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD5",32,0,random(-6,6),8)
			Goto MissileEnd
		Bullet6:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD6",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD6",32,0,random(-6,6),8)
			Goto MissileEnd
		Bullet7:
			BS32 B 6 Bright A_CustomMissile("BlakeEnemyBulletD7",32,0,random(-6,6),8)
			TNT1 A 0 A_PlaySound("Bpistol2/Fire", CHAN_WEAPON)
			BS32 C 6 Bright A_CustomMissile("BlakeEnemyBulletD7",32,0,random(-6,6),8)
			Goto MissileEnd
		MissileEnd:
			BS32 A 5
			Goto See		
		Death:
		XDeath:
			BS32 D 6 A_Scream
			BS32 E 6 A_NoBlocking
			BSE6 G 6 A_SpawnItem("PerTurretDrop")
			BSE6 H 6
			BSE6 IJK 6
			BSE6 L -1
			Stop			
		}
}		

Actor PerTurretDrop
{
	+CLIENTSIDEONLY
	-SOLID
	Scale 1.15
	States
	{
		Spawn:
			BS32 FG 6
			BS32 H -1
			Stop
		}
}		