actor PlasmaSphere {
	MONSTER
	Health 1
	SeeSound ""
	AttackSound "plasmaalien/hit"
	PainSound ""
	DeathSound "plasmaalien/death"
	ActiveSound ""
	Species "Enemies"
	Speed 10
	FloatSpeed 10
	Painchance 0
	DamageFactor "PlasmaSphere", 0.0
	Height 24
	Radius 12
	Mass 32
	Obituary "%o didn't see the Plasma Sphere nearby."
	Tag "Plasma Sphere"
	RenderStyle Add
    +NOPAIN
	+NOBLOOD
	+NOGRAVITY
	+FLOAT
	+NOTARGET
	-COUNTKILL
	+DONTHARMCLASS
	+DONTHARMSPECIES
    States {
      Spawn:
		BSE9 A 0
		BSE9 A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
		BSE9 A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		BSE9 A 0 A_GiveInventory("AlreadySpawned",1)
	  Spawn2:
        BSE9 ABC 10 A_Look
        Loop
      See:
	    TNT1 A 0 A_Chase
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
        BSE9 A 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 A 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 A 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 B 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 B 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 B 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 C 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 C 2 A_SpawnItem("PlasmaSphereDamager")
		TNT1 A 0 A_GiveInventory("FaceCheck", 1)
		BSE9 C 2 A_SpawnItem("PlasmaSphereDamager")
        Loop
	  Death:
	  XDeath:
        TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
        BSE9 D 6 
        BSE9 E 6 A_Scream
        BSE9 F 6 
        BSE9 G 6 A_NoBlocking
        BSE9 H 6
        TNT1 A -1
        Stop
      Death.ZorchPistol:
	  Death.Zorch:
	  Death.ZorchKamikaze:
	  Death.PhasingZorch:
	  Death.ZorchSpectral:
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_Stop
		"####" "#" 0 A_NoGravity		
		"####" "#" 0 A_ChangeFlag("DONTGIB",1)
		"####" "#" 0 A_PlaySoundEx("chex/zorch","soundslot5",0,0)
		"####" "#" 3 A_SpawnItem("ZorchEffectSmall")
		"####" "#" 0 A_GiveInventory("EnemyZorched",1)
		"####" "#" 3 A_SetTranslucent(0.9,0)
		"####" "#" 0 A_Scream
		"####" "#" 3 A_SetTranslucent(0.8,0)
		"####" "#" 0 A_NoBlocking
		"####" "#" 3 A_SetTranslucent(0.7,0)
		"####" "#" 3 A_SetTranslucent(0.6,0)
		"####" "#" 3 A_SetTranslucent(0.5,0)
		"####" "#" 3 A_SetTranslucent(0.4,0)
		"####" "#" 3 A_SetTranslucent(0.3,0)
		"####" "#" 3 A_SetTranslucent(0.2,0)
		"####" "#" 3 A_SetTranslucent(0.1,0) 
		TNT1 A 1 A_SetTranslucent(1,0)
		TNT1 A -1
		stop
	  Death.DukeExplosive:
      Death.DukeDamage:
      Death.DukePistol:
        TNT1 A 0 A_Jump(218,"Death")
        TNT1 A 0 A_GiveToTarget("DukeKillTaunt",1)
        goto Death
      Death.MightyBoot:
        TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
        TNT1 A 0 A_Jump(64,"Death")
        TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
        goto Death
      Death.Vodoo:
	  Death.VoodooPuff:
	  Death.DynamiteCoop:
	  Death.Dynamite:
	  Death.LifeLeech:
	  Death.CalebNapalm:
	  Death.Shock:	  
	  Death.Vodoo:
	  Death.Tesla:
	  Death.CalebFire:	
	  Death.CalebBullet:	
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		Goto Death
	  Death.EradExplosive:
	  Death.EradNova:
	  Death.EradShock:
	  Death.EradExplosive2:	
	  Death.EradDisc:
	  Death.EradPiercingDart:
	  Death.EradGreenFire:
	  Death.EradCoopGreenFire:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("EleenaDMTaunt1", 1)
		Goto Death
      Death.PSRAPower:
	  Death.PSRAPowerCoop:
	  Death.PSExplosive:
	  Death.PSExplosiveCoop:
	  Death.PSBullet:
	  Death.PSFire:	
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("JonDMTaunt1", 1)
		Goto Death
	  Death.LeonardDamage2:
	  Death.LeonardDamage3:
	  Death.LeonardDamage0:
	  Death.LeonardDamage1:	
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LeonardDMTaunt1", 1)
		Goto Death
	  Death.SWSticky:
	  Death.SWStickyCoop:	  
	  Death.SWGrenade:
	  Death.SWNuke:
	  Death.SWRocket:
	  Death.SWRailgun:
	  Death.SWRailgunCoop:
	  Death.SWNukeCoop:
	  Death.SWFlame:
	  Death.SWFlame2:
	  Death.SWFlame2Coop:
	  Death.SWFlame3:	
	  Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		goto Death
	  Death.DukeIce:
		"####" "#" 0 A_PlaySound("duke/enemyfreeze")
		"####" "#" 0 A_GiveInventory("FreezethrowerWeakness")
		"####" "#" 0 A_Jump(218,"Ice")
		"####" "#" 0 A_GiveToTarget("DukeKillTaunt",1)
	  Ice:
	  Death.HexenIce:
	  Death.WTMeleeIce:
	  Death.WTRangedIce:
	  Death.Ice:
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_GenericFreezeDeath
		"####" "#" 70 A_UnsetSolid
		"####" "#" 0 A_IceGuyDie
		"####" "#" 1 A_IceGuyDie
		TNT1 A 0
		stop
      Pain.MightyBoot:
        TNT1 A 0 A_ChangeFlag("NOPAIN",1)
        TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
        BSE9 A 2 A_FaceTarget
        TNT1 A 0 A_Recoil(14)
        BSE9 A 16 A_Pain
        Goto See
	  Death.RottDisintegrate:
		"####" "#" 0 A_ChangeFlag("SOLID", 0)
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_Scream
		"####" "#" 0 A_NoBlocking	
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 0 A_Stop
		"####" "#" 0 A_ChangeFlag("SHOOTABLE",FALSE)
		"####" "#" 0 A_ChangeFlag("NOGRAVITY",TRUE)
		"####" "#" 0 A_ChangeFlag("FLOORCLIP",TRUE)
		"####" "#" 0 A_SpawnItem("RGodModeDeathTiny")
		"####" "#" 3 A_SetTranslucent(0.9,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.8,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.7,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.6,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.5,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.4,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.3,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.2,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.1,0)
		stop
	  Disintegrate:
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_NoBlocking
		"####" "#" 0 A_ChangeFlag("DONTGIB",1)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 0 A_Scream
		"####" "#" 0 A_ChangeFlag("SOLID",FALSE)
		"####" "#" 0 A_ChangeFlag("SHOOTABLE",FALSE)
		"####" "#" 0 A_ChangeFlag("NOGRAVITY",TRUE)
		"####" "#" 0 A_ChangeFlag("FLOORCLIP",TRUE)
		"####" "#" 0 A_Stop
		"####" "#" 3 A_SpawnItem("DisintEffectTiny",0,10)
		"####" "#" 3 A_SetTranslucent(0.9,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.8,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.7,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.6,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 3 A_SetTranslucent(0.5,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.4,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.3,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.2,0)
		"####" "#" 0 ACS_NamedExecuteAlways("ExtraDeathFX",0,1)
		"####" "#" 2 A_SetTranslucent(0.1,0)
        stop
	  Death.Nuke:
		"####" "#" 0 A_ChangeFlag("SOLID", 0)
		"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		"####" "#" 0 A_Scream
		"####" "#" 0 A_NoGravity		
		"####" "#" 0 A_NoBlocking		
		"####" "#" 0 A_SpawnItem("WTNukeDeathTiny")
		"####" "#################" 3 A_Fadeout(0.05)
		stop	
    }
}

Actor PlasmaSphereDamager {
	Height 2
	Radius 2
	+NOGRAVITY
	DamageType "PlasmaSphere"
	States {
		Spawn:
			TNT1 AA 1 A_Explode(Random(1, 4), 32, 0) //Nerfed due to obvious reasons
		Stop
	}
}

Actor FaceCheck : CustomInventory {
	inventory.maxamount 1
	+AUTOACTIVATE
	+ALWAYSPICKUP
	States {
		Pickup:
		Use:
			TNT1 A 0 A_JumpIfTargetInLOS("Face", 0)
			TNT1 A 0 A_Chase
		Stop
		Face:
			TNT1 A 0 A_FaceTarget
			TNT1 A 0 ThrustThing(angle*256/360, 2, 1, 0)
		Stop
	}
}

ACTOR MultiPlasmaSphere : PlasmaSphere {
	Species "PlasmaSphere"
	+THRUSPECIES
}