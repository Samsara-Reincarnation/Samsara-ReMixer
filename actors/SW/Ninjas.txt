Actor SWNinja : SamsaraMonsterHumanoid
{
	Health 40
	Radius 20
	Height 56
	Speed 8
	PainChance 128
	Mass 128
	Monster
	+FLOORCLIP
	+NOINFIGHTING
	+DONTHARMCLASS
	+DONTHARMSPECIES
	+NOBLOODDECALS
	SeeSound "Ninja/See"
	AttackSound "Ninja/uzi"
	PainSound "Ninja/pain"
	DeathSound "Ninja/die"
	ActiveSound "Ninja/Act"
	Obituary "%o was killed by a pesky ninja."
	Species "SWEnemies"
	Tag "Evil Ninja"  
	XScale 0.6
	Yscale 0.58
	BloodType "SWDefaultBloodSpawner"	
	DropItem "SWNinjaDrop"
	PainChance "MightyBoot", 255
	PainChance "MarathonStun", 255		
	States
	{
	Spawn:
		NINJ A 0
		NINJ A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
		NINJ A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		NINJ A 0 A_GiveInventory("AlreadySpawned",1)
    Spawn2:
		TNT1 A 0 A_Jump(256,3)
		TNT1 A 0 A_Jump(184,2)
		TNT1 A 0 A_GiveInventory("CultistIsCrawling",1)	
		TNT1 A 0
	SpawnLoop:		
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"SpawnCrawl")			
		NINJ A 10 A_Look
		Loop
	SpawnCrawl:
		NINJ K 10 A_Look
		Loop
	See:
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"Crawling")				
	SeeLoop:	
		NINJ AAA 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ BBB 2 A_Chase
		TNT1 A 0 A_Jump(1, "Suicide")
		NINJ CCC 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ DDD 2 A_Chase
		Loop
	Crawling:
		NINJ KKK 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ LLL 2 A_Chase
		NINJ MMM 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ NNN 2 A_Chase
		Loop		
	Missile:
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		TNT1 A 0 A_Jump(96, "Shuriken")
		NINJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NINJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(5,7), "BulletPuffSW", 0, CBAF_NORANDOM)
		NINJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NINJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(5,7), "BulletPuffSW", 0, CBAF_NORANDOM)
		NINJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NINJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(5,7), "BulletPuffSW", 0, CBAF_NORANDOM)
		NINJ E 4
		Goto See
	Shuriken:
		NINJ OOO 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)
		NINJ P 4 A_CustomMissile("ShurikenShotNinja")
		NINJ Q 4
		Goto See
	Pain:
		NINJ R 3
		NINJ R 3 A_Pain
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_JumpIfHealthLower(50,"Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Pain.MightyBoot:
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
		NINJ R 2 A_FaceTarget
		TNT1 A 0 A_Recoil(14)
		NINJ R 16 A_Pain
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_JumpIfHealthLower(50,"Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0
		Goto See
	Pain.ZorchPistol:
	Pain.Zorch:
	Pain.ZorchKamikaze:
	Pain.PhasingZorch:
	Pain.ZorchSpectral:
		NINJ R 3
		NINJ R 3 A_Pain
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Choke:
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_PlaySound("Ninja/Choke")
		NINB ABCBABC 5
		TNT1 A 0 A_Jump(96,"ChokeFinish")
		NINB BABCBA 5
		TNT1 A 0 A_Jump(128,"ChokeFinish")
		NINB BC 5
	ChokeFinish:
		NINJ R 1 A_Die
		Wait
	Suicide:
		NINS A 8
		NINS B 65
		NINS B 5 A_Die("SuicideDeath")
		Wait
	Death: 
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")
		NINJ R 4 A_StopSound(CHAN_BODY)
		NINJ S 3 A_Scream
		NINJ T 3 A_NoBlocking
		NINJ UVWX 3
		NINJ Y 0 A_SpawnItemEx("SWNinjaCorpse_Normal", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop
	Death.SuicideDeath:
		TNT1 A 0 A_Stop
		TNT1 A 0 A_GiveInventory("SWEnemy_SuicideDeath", 1)	
		TNT1 A 0 A_PlaySound("ninja/uzi")
		TNT1 A 0 A_PlaySound("sw/gib_start")
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")	
		NINS C 6 A_NoBlocking
		NINS DEFG 6
		NINS H 0 A_SpawnItemEx("SWNinjaCorpse_Suicide", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop
	XDeath:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreXDeathEffect")
		TNT1 A 0 A_NoBlocking
		TNT1 A 5 A_SpawnItemEx("SWHumanGibSpawner")
		TNT1 A -1
		Stop
	Death.SWKatana:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  	
		TNT1 A 0 A_Stop
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_GiveInventory("SWEnemy_SwordDeath", 1)	
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(128, 1)
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		NINC A 30 A_PlaySound("ninja/Cut",6)
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")	
		NINC BCDEFGHI 5
		NINJ J 0 A_SpawnItemEx("SWNinjaCorpse_Sword", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop
	Death.SWFist:
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWFisted")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait	
	Death.SWShuriken:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWShurikend")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWSticky:
	Death.SWStickyCoop:		
	Death.SWGrenade:
	Death.SWNuke:
	Death.SWRocket:
	Death.SWRailgun:
	Death.SWRailgunCoop:
	Death.SWNukeCoop:
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
	Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWFlame:
	Death.SWFlame2:
	Death.SWFlame2Coop:
	Death.SWFlame3:	
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
		TNT1 A 0 A_Jump(218, "Burn")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Burn")
		wait
	XDeathForWang:
		TNT1 A 0 A_ChangeFlag("SOLID",false)
		TNT1 A 0 A_Jump(218, "XDeath")	
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt2",1)
		TNT1 A -1 A_Jump(256,"XDeath")
		wait
    Death.CalebFire:
	Death.LifeLeech:
		TNT1 A 0 A_Jump(218, 2)
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		TNT1 A 0 A_SpawnItemEx("BloodBurningCorpse_Generic", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		TNT1 A 0 A_Stop
		TNT1 A 5 A_NoBlocking
		TNT1 A -1 ACS_NamedExecuteWithResult("SamsaraBossDeathToggler")
		Stop
	Pain.ShrinkerDMG:
		NINJ R 0
		"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
		"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
		"####" "#" 0 A_ChangeFlag("NOPAIN", 1)
		"####" "#" 0 A_ChangeFlag("NODAMAGE", 1)
		"####" "#" 0 A_NoBlocking
		"####" "#" 0 A_PlaySound("duke/shrink")
		"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
		"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("SWNinja_Shrink", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERSPECIAL|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
		TNT1 A 2
		TNT1 A 0 Thing_Remove(0)
		stop
	}
}

Actor SWNinjaDropRandom : RandomSpawner
{
	DropItem "SWEnemy_UziMagDrop", 256, 2
	DropItem "SWEnemy_ShurikenDrop", 256, 6
}	

Actor SWNinjaDrop {
	Height 5
	Radius 5
	+NOCLIP
	+FLOORCLIP
	States {
		Spawn:
			TNT1 A 0 
			TNT1 A 0 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,4,0)
			TNT1 A 15
			TNT1 A 0 A_JumpIfInventory("WeaponDropToken", 1, "Spawn2")
			TNT1 A 1 Bright A_DropItem("SWNinjaDropRandom", 1, 178)
			Stop
		Spawn2:
			TNT1 A 1 Bright A_DropItem("SWRiotGunDrop", 1, 178)
			Stop
	}
}

Actor SWNinjaCorpse_Normal : SamsaraCorpseActor
{
	Health 20
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NINJ Y 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaCorpse_Sword : SamsaraCorpseActor
{
	Health 20
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NINC J 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaCorpse_Suicide : SamsaraCorpseActor
{
	Health 20
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NINS H 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

actor SWNinja_Shrink : SWNinja
{
	+FRIGHTENED
	+NOTRIGGER
	-SHOOTABLE
	+THRUACTORS
	+NORADIUSDMG
	+VULNERABLE
	+QUICKTORETALIATE
	+COUNTKILL
	-NOGRAVITY
	+NODAMAGE
	+NOPAIN
	MaxStepHeight 0
	MaxDropOffHeight 0
	MeleeRange 16
	Height 16
	Health 1
	Speed 1
	PainChance "ShrinkDMG", 0
	DamageFactor "ShrinkDMG", 0.0
	PainChance "ExpanderDMG", 0
	DamageFactor "ExpanderDMG", 0.0
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_JumpIfInventory("ShrunkToken",1,"SpawnLoop")
			TNT1 A 0 A_SetUserVar("user_scalex", scalex*65536.0)
			TNT1 A 0 A_SetUserVar("user_scaley", scaley*65536.0)
			TNT1 A 0 A_SetScale(scalex*0.2,scaley*0.2) // setting the scale in ACS does work, but the actor shows up at normal size for a split second
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_Shrinker", 0, 1)
			NINJ R 10
			Goto See
		SpawnLoop:
			NINJ A 5 A_Look
			Loop
		See:
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIf(CallACS("Samsara_Shrinker", 3) == 0, "Forget")
			Loop
		Forget:
			"####" "#" 0 A_ClearTarget
			Goto See
		Grow:
			"####" "#" 4 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(1.0*(user_scalex/65536.0),1.0*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("SWNinja", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERSPECIAL|SXF_TRANSFERPOINTERS|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 2 Thing_Remove(0)
			stop
		Squish:
			"####" "#" 0 A_GiveInventory("SquishToken", 1)
			"####" "#" 0 A_JumpIfInTargetInventory("DukeStomp", 1, 2)
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 2 
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 0 
			"####" "#" 2 A_Die("Squish")
			"####" "#" 0
			loop
		Death:
		XDeath:
		Death.Squish:
		XDeath.Squish:
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			stop
		DukeStomp:
			"####" "#" 0 A_GiveToTarget("DukeStomp", 1)
			Goto Squish
	}
}

actor SWNinja_ShrinkEffect : SWNinja
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			NINJ R 0
			NINJ R 0 A_SetUserVar("user_scalex", scalex*65536.0)
			NINJ R 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

actor ShurikenShotNinja : SWThrownShuriken
{
	Obituary "%o was killed by a pesky ninja."
	DamageType ""
	BounceSound "sw/shuriken_clank"
	States
	{
	Death:
	Crash:
		TNT1 A 1 A_PlaySound("shuriken/hit")
		Stop
	XDeath:
		TNT1 A 1 A_PlaySound("sw/fists_wall")
		Stop
	}
}

Actor NinjaBodyFlyBrown
{
	PROJECTILE
	+CLIENTSIDEONLY
	Damage 0
	Height 32
	Radius 18
    XScale 0.6
    Yscale 0.58
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 ThrustThing(angle*256/360+128, random(8,24), 0, 0)
			TNT1 A 0 ThrustThingZ(0, random(12,28), 0, 0)
			NINJ U 3
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		SpawnLoop:
			NINJ U 3 A_CheckFloor("Landed")
			Loop
		Death:
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
			NINJ U 3 A_CheckFloor("Landed")
			Goto Death+1
		Landed:
		    NINJ U 3
			TNT1 A 0 A_PlaySound("Body/Land", 6)
			NINJ VW 3
			TNT1 A 0 A_PlaySound("Ninja/die")
			NINJ X 3
			NINJ Y -1
			Stop
	}
}

Actor NinjaRed : SWNinja 
{
  Health 160
  AttackSound "Ninja/Uzi2"
  Obituary "%o was killed by a red belt ninja."
  PainChance 96
  DropItem "SWRedNinjaDropRandom", 178
  +BOSSDEATH
  +DONTRIP
  +FLOORCLIP
  +NOINFIGHTING
  +DONTHARMCLASS
  +DONTHARMSPECIES
  States
  {
	Spawn:
		NIRJ A 0
		NIRJ A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
		NIRJ A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		NIRJ A 0 A_GiveInventory("AlreadySpawned",1)
    Spawn2:
		TNT1 A 0 A_Jump(256,3)
		TNT1 A 0 A_Jump(184,2)
		TNT1 A 0 A_GiveInventory("CultistIsCrawling",1)	
		TNT1 A 0
	SpawnLoop:		
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"SpawnCrawl")
		NIRJ A 10 A_Look
		Loop
	SpawnCrawl:
		NIRJ K 10 A_Look
		Loop
	See:
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"Crawling")				
	SeeLoop:	
		NIRJ AAA 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIRJ BBB 2 A_Chase
		NIRJ CCC 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIRJ DDD 2 A_Chase
		Loop
	Crawling:
		NIRJ KKK 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIRJ LLL 2 A_Chase
		NIRJ MMM 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIRJ NNN 2 A_Chase
		Loop	
	Missile:
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		TNT1 A 0 A_Jump(84, "PowerShot", "Shuriken")
		NIRJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)
		NIRJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIRJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIRJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIRJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIRJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIRJ E 4		
		Goto See
	PowerShot:
		NIRJ AAA 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("Weapons/MissileLaunch", 5)		
		NIRJ A 4 A_CustomMissile("HeavyMissileWeak")
		NIRJ AA 4
		Goto See
	Shuriken:
		NIDB DDD 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)
		NIDB E 4 A_CustomMissile("ShurikenShotNinja")
		NIDB F 4
		Goto See		
	Pain:
		NIRJ R 3
		NIRJ R 3 A_Pain
		TNT1 A 0 A_Jump(128, 2)
		TNT1 A 0 A_JumpIfHealthLower(50, "Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(180,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Pain.MightyBoot:
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
		NIRJ R 2 A_FaceTarget
		TNT1 A 0 A_Recoil(14)
		NIRJ R 16 A_Pain
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_JumpIfHealthLower(50,"Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0
		Goto See
	Pain.ZorchPistol:
	Pain.Zorch:
	Pain.ZorchKamikaze:
	Pain.PhasingZorch:
	Pain.ZorchSpectral:
		NIRJ R 3
		NIRJ R 3 A_Pain
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Choke:
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_PlaySound("Ninja/Choke")
		NIRB ABCBABC 5
		TNT1 A 0 A_Jump(96, "ChokeFinish")
		NIRB BABCBA 5
		TNT1 A 0 A_Jump(128, "ChokeFinish")
		NIRB BC 5
	ChokeFinish:
		NIRJ R 1 A_Die
		Wait
	Death:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")
		NIRJ R 4 A_StopSound(CHAN_BODY)	
		NIRJ S 3 A_Scream
		NIRJ T 3 A_NoBlocking
		NIRJ UVWX 3
		NIRJ Y 0 A_KillMaster
		NIRJ Y 0 A_SpawnItemEx("SWNinjaRedCorpse_Normal", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop
	XDeath:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreXDeathEffect")
		TNT1 A 0
		TNT1 A 0 A_NoBlocking
		TNT1 A 5 A_SpawnItemEx("SWHumanGibSpawner")
		TNT1 A -1 A_KillMaster
		Stop	
	Death.SWKatana:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  	
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_GiveInventory("SWEnemy_SwordDeath", 1)			
		TNT1 A 0 A_Stop
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(128, 1)
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		NIRC A 30 A_PlaySound("ninja/Cut",6)
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")	
		NIRC BCDEFGHI 5
		NIRC J 0 A_KillMaster
		NIRC J 0 A_SpawnItemEx("SWNinjaRedCorpse_Sword", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop
	Death.SWFist:
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWFisted")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait	
	Death.SWShuriken:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWShurikend")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWSticky:
	Death.SWStickyCoop:		
	Death.SWGrenade:
	Death.SWNuke:
	Death.SWRocket:
	Death.SWRailgun:
	Death.SWRailgunCoop:
	Death.SWNukeCoop:
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
	Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWFlame:
	Death.SWFlame2:
	Death.SWFlame2Coop:
	Death.SWFlame3:	
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
		TNT1 A 0 A_Jump(218, "Burn")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Burn")
		wait
	XDeathForWang:
		TNT1 A 0 A_ChangeFlag("SOLID",false)
		TNT1 A 0 A_Jump(218, "XDeath")	
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt2",1)
		TNT1 A -1 A_Jump(256,"XDeath")
		wait
    Death.CalebFire:
	Death.LifeLeech:
		TNT1 A 0 A_Jump(218, 2)
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		TNT1 A 0 A_SpawnItemEx("BloodBurningCorpse_Generic", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		TNT1 A 0 A_Stop
		TNT1 A 5 A_NoBlocking
		TNT1 A -1 ACS_NamedExecuteWithResult("SamsaraBossDeathToggler")
		Stop
	Pain.ShrinkerDMG:
		NIRJ R 0
		"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
		"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
		"####" "#" 0 A_ChangeFlag("NOPAIN", 1)
		"####" "#" 0 A_ChangeFlag("NODAMAGE", 1)
		"####" "#" 0 A_ChangeFlag("SOLID",false)
		"####" "#" 0 A_PlaySound("duke/shrink")
		"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
		"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaRed_Shrink", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERSPECIAL|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
		TNT1 A 2
		TNT1 A 0 A_ChangeFlag("COUNTKILL", 0)
		TNT1 A 0 A_ChangeFlag("NODAMAGE", 1)
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_ChangeFlag("VULNERABLE", 1)
		TNT1 A 0 A_ChangeFlag("SHOOTABLE", 0)
		Goto ShrunkLoop
	ShrunkLoop:
		TNT1 A 2 A_JumpIfInventory("MasterDeadToken",1,"ShrunkDie")
		loop
	ShrunkDie:
		TNT1 A 0
		TNT1 A 1 A_Die("Shrink")
		stop
	Death.Shrink:
		TNT1 A 0
		TNT1 A 1 A_KillMaster
		stop
    }
}

Actor SWRedNinjaDropRandom : RandomSpawner
{
	DropItem "SWEnemy_UziMagDrop", 256, 5
	DropItem "SWEnemy_RocketAmmoDrop", 256, 3
}	

Actor SWNinjaRedCorpse_Normal : SamsaraCorpseActor
{
	Health 30
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIRJ Y 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaRedCorpse_Sword : SamsaraCorpseActor
{
	Health 30
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIRC J 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaRedCorpse_Suicide : SamsaraCorpseActor
{
	Health 30
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIRS H 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

actor NinjaRed_Shrink : NinjaRed
{
	+FRIGHTENED
	+NOTRIGGER
	-SHOOTABLE
	+THRUACTORS
	+NORADIUSDMG
	+VULNERABLE
	+QUICKTORETALIATE
	+COUNTKILL
	-NOGRAVITY
	+NODAMAGE
	+NOPAIN
	MaxStepHeight 0
	MaxDropOffHeight 0
	MeleeRange 16
	Height 16
	Health 1
	Speed 1
	PainChance "ShrinkDMG", 0
	DamageFactor "ShrinkDMG", 0.0
	PainChance "ExpanderDMG", 0
	DamageFactor "ExpanderDMG", 0.0
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_JumpIfInventory("ShrunkToken",1,"SpawnLoop")
			TNT1 A 0 A_SetUserVar("user_scalex", scalex*65536.0)
			TNT1 A 0 A_SetUserVar("user_scaley", scaley*65536.0)
			TNT1 A 0 A_SetScale(scalex*0.2,scaley*0.2) // setting the scale in ACS does work, but the actor shows up at normal size for a split second
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_Shrinker", 0, 1)
			NIRJ R 10
			Goto See
		SpawnLoop:
			NIRJ A 5 A_Look
			Loop
		See:
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIRJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIf(CallACS("Samsara_Shrinker", 3) == 0, "Forget")
			Loop
		Forget:
			"####" "#" 0 A_ClearTarget
			Goto See
		Grow:
			"####" "#" 4 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(1.0*(user_scalex/65536.0),1.0*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("NinjaRed", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERSPECIAL|SXF_TRANSFERPOINTERS|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 2 Thing_Remove(0)
			stop
		Squish:
			"####" "#" 0 A_GiveInventory("SquishToken", 1)
			"####" "#" 0 A_JumpIfInTargetInventory("DukeStomp", 1, 2)
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 2 
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 0 
			"####" "#" 2 A_Die("Squish")
			"####" "#" 0
			loop
		Death:
		XDeath:
		Death.Squish:
		XDeath.Squish:
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A 0 A_GiveInventory("MasterDeadToken", 1, AAPTR_Master)
			stop
		DukeStomp:
			"####" "#" 0 A_GiveToTarget("DukeStomp", 1)
			Goto Squish
	}
}

actor NinjaRed_ShrinkEffect : NinjaRed
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			NIRJ R 0
			NIRJ R 0 A_SetUserVar("user_scalex", scalex*65536.0)
			NIRJ R 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

Actor NinjaBodyFlyRed : NinjaBodyFlyBrown
{
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 ThrustThing(angle*256/360+128, random(8,24), 0, 0)
			TNT1 A 0 ThrustThingZ(0, random(12,28), 0, 0)
			NIRJ U 3
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		SpawnLoop:
			NIRJ U 3 A_CheckFloor("Landed")
			Loop
		Death:
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
			NIRJ U 3 A_CheckFloor("Landed")
			Goto Death+1
		Landed:
		    NIRJ U 3
			TNT1 A 0 A_PlaySound("Body/Land", 6)
			NIRJ VW 3
			TNT1 A 0 A_PlaySound("Ninja/die")
			NIRJ X 3
			NIRJ Y -1
			Stop
	}
}

Actor HeavyMissileWeak : HeavyMissile
{
	Speed 24
	Obituary "%o was killed by a red belt ninja."
	SeeSound "Weapons/MissileLaunch"
    DamageType ""
	States
	{
		Death:
			TNT1 A 0 A_Explode(Random(40,60), 128)
			TNT1 A 0 A_PlaySound("Weapons/MissileHitX")
			TNT1 A 5 A_SpawnItem("BigMissileExplosion")
			Stop
	}
}

Actor HeavyMissileSeekingWeak : HeavyMissileWeak
{
	Obituary "%o was killed by an orange belt ninja."
	Damage (Random(15,30))
	+SEEKERMISSILE
	Speed 22	
	States
	{
		Spawn:
			TNT1 A 0 A_PlaySound("Weapons/MissileBeep")
			HROC A 2 A_SeekerMissile (10, 20)
			TNT1 A 0 A_SpawnItemEx("HeavyRocketTrail", -4, 0, 2)
			HROC A 2 A_SeekerMissile (10, 20)
			TNT1 A 0 A_SpawnItemEx("HeavyRocketTrail", -4, 0, 2)
			HROC A 2 A_SeekerMissile (10, 20)
			TNT1 A 0 A_SpawnItemEx("HeavyRocketTrail", -4, 0, 2)
			Loop
	}
}

Actor NinjaOrange : NinjaRed 
{
	Health 160
	+DONTRIP
	+FLOORCLIP
	+NOINFIGHTING
	+DONTHARMCLASS
	+DONTHARMSPECIES
	AttackSound "Ninja/Uzi2"
	Obituary "%o was killed by an orange belt ninja."
	PainChance 96
	DropItem "SWOrangeNinjaDropRandom", 178
	States
	{
	Spawn:
		NIOJ A 0
		NIOJ A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
		NIOJ A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		NIOJ A 0 A_GiveInventory("AlreadySpawned",1)
    Spawn2:
		TNT1 A 0 A_Jump(256,3)
		TNT1 A 0 A_Jump(184,2)
		TNT1 A 0 A_GiveInventory("CultistIsCrawling",1)	
		TNT1 A 0
	SpawnLoop:		
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"SpawnCrawl")	
		NIOJ A 10 A_Look
		Loop
	SpawnCrawl:
		NIOJ K 10 A_Look
		Loop
	See:
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"Crawling")		
	SeeLoop:	
		NIOJ AAA 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIOJ BBB 2 A_Chase
		NIOJ CCC 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIOJ DDD 2 A_Chase
		Loop
	Crawling:
		NIOJ KKK 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIOJ LLL 2 A_Chase
		NIOJ MMM 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIOJ NNN 2 A_Chase
		Loop		
	Missile:
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		TNT1 A 0 A_Jump(84, "PowerShot", "Shuriken")
		NIOJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIOJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIOJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIOJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIOJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIOJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIOJ E 4
		Goto See
	PowerShot:
		NIOJ AAA 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("Weapons/MissileLaunch",5)		
		NIOJ E 4 A_CustomMissile("HeavyMissileSeekingWeak")
		NIOJ EE 4
		Goto See
	Shuriken:
		NIDB GGG 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)
		NIDB H 4 A_CustomMissile("ShurikenShotNinja")
		NIDB I 4
		Goto See				
	Pain:
		NIOJ R 3
		NIOJ R 3 A_Pain
		TNT1 A 0 A_Jump(128, 2)
		TNT1 A 0 A_JumpIfHealthLower(50, "Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(180,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0				
		Goto See
	Pain.MightyBoot:
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
		NIOJ R 2 A_FaceTarget
		TNT1 A 0 A_Recoil(14)
		NIOJ R 16 A_Pain
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_JumpIfHealthLower(50,"Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0
		Goto See
	Pain.ZorchPistol:
	Pain.Zorch:
	Pain.ZorchKamikaze:
	Pain.PhasingZorch:
	Pain.ZorchSpectral:
		NIOJ R 3
		NIOJ R 3 A_Pain
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Choke:
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_PlaySound("Ninja/Choke")
		NIOB ABCBABC 5
		TNT1 A 0 A_Jump(96, "ChokeFinish")
		NIOB BABCBA 5
		TNT1 A 0 A_Jump(128, "ChokeFinish")
		NIOB BC 5
	ChokeFinish:
		NOIJ R 1 A_Die
		Wait
	Death:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)    
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect") 
		NIOJ R 4 A_StopSound(CHAN_BODY)	
		NIOJ S 3 A_Scream
		NIOJ T 3 A_NoBlocking
		NIOJ UVWX 3
		NIOJ Y 0 A_KillMaster
		NIOJ Y 0 A_SpawnItemEx("SWNinjaOrangeCorpse_Normal", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop	
	Death.SWKatana:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  	
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_GiveInventory("SWEnemy_SwordDeath", 1)	
		TNT1 A 0 A_Stop
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(128, 1)
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		NIOC A 30 A_PlaySound("ninja/Cut",6)
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")	
		NIOC BCDEFGHI 5
		NIOC J 0 A_KillMaster
		NIOC J 0 A_SpawnItemEx("SWNinjaOrangeCorpse_Sword", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop	
	Death.SWFist:
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWFisted")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait	
	Death.SWShuriken:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWShurikend")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWSticky:
	Death.SWStickyCoop:		
	Death.SWGrenade:
	Death.SWNuke:
	Death.SWRocket:
	Death.SWRailgun:
	Death.SWRailgunCoop:
	Death.SWNukeCoop:
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
	Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWFlame:
	Death.SWFlame2:
	Death.SWFlame2Coop:
	Death.SWFlame3:	
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
		TNT1 A 0 A_Jump(218, "Burn")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Burn")
		wait
	XDeathForWang:
		TNT1 A 0 A_ChangeFlag("SOLID",false)
		TNT1 A 0 A_Jump(218, "XDeath")	
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt2",1)
		TNT1 A -1 A_Jump(256,"XDeath")
		wait
    Death.CalebFire:
	Death.LifeLeech:
		TNT1 A 0 A_Jump(218, 2)
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		TNT1 A 0 A_SpawnItemEx("BloodBurningCorpse_Generic", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		TNT1 A 0 A_Stop
		TNT1 A 5 A_NoBlocking
		TNT1 A -1 ACS_NamedExecuteWithResult("SamsaraBossDeathToggler")
		Stop
	Pain.ShrinkerDMG:
		NIOJ R 0
		"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
		"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
		"####" "#" 0 A_ChangeFlag("NOPAIN", 1)
		"####" "#" 0 A_ChangeFlag("NODAMAGE", 1)
		"####" "#" 0 A_ChangeFlag("SOLID",false)
		"####" "#" 0 A_PlaySound("duke/shrink")
		"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
		"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaOrange_Shrink", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERSPECIAL|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
		TNT1 A 2
		TNT1 A 0 A_ChangeFlag("COUNTKILL", 0)
		TNT1 A 0 A_ChangeFlag("NODAMAGE", 1)
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_ChangeFlag("VULNERABLE", 1)
		TNT1 A 0 A_ChangeFlag("SHOOTABLE", 0)
		Goto ShrunkLoop
	ShrunkLoop:
		TNT1 A 2 A_JumpIfInventory("MasterDeadToken",1,"ShrunkDie")
		loop
	ShrunkDie:
		TNT1 A 0
		TNT1 A 1 A_Die("Shrink")
		stop
	Death.Shrink:
		TNT1 A 0
		TNT1 A 1 A_KillMaster
		stop
    }
}

Actor SWOrangeNinjaDropRandom : RandomSpawner
{
	DropItem "SWEnemy_UziMagDrop", 256, 5
	DropItem "SWEnemy_SeekerCardDrop", 256, 1
}	

Actor SWNinjaOrangeCorpse_Normal : SamsaraCorpseActor
{
	Health 35
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIOJ Y 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaOrangeCorpse_Sword : SamsaraCorpseActor
{
	Health 35
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIOC J 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaOrangeCorpse_Suicide : SamsaraCorpseActor
{
	Health 35
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIOS H 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

actor NinjaOrange_Shrink : NinjaOrange
{
	+FRIGHTENED
	+NOTRIGGER
	-SHOOTABLE
	+THRUACTORS
	+NORADIUSDMG
	+VULNERABLE
	+QUICKTORETALIATE
	+COUNTKILL
	-NOGRAVITY
	+NODAMAGE
	+NOPAIN
	MaxStepHeight 0
	MaxDropOffHeight 0
	MeleeRange 16
	Height 16
	Health 1
	Speed 1
	PainChance "ShrinkDMG", 0
	DamageFactor "ShrinkDMG", 0.0
	PainChance "ExpanderDMG", 0
	DamageFactor "ExpanderDMG", 0.0
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_JumpIfInventory("ShrunkToken",1,"SpawnLoop")
			TNT1 A 0 A_SetUserVar("user_scalex", scalex*65536.0)
			TNT1 A 0 A_SetUserVar("user_scaley", scaley*65536.0)
			TNT1 A 0 A_SetScale(scalex*0.2,scaley*0.2) // setting the scale in ACS does work, but the actor shows up at normal size for a split second
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_Shrinker", 0, 1)
			NIOJ R 10
			Goto See
		SpawnLoop:
			NIOJ A 5 A_Look
			Loop
		See:
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIOJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIf(CallACS("Samsara_Shrinker", 3) == 0, "Forget")
			Loop
		Forget:
			"####" "#" 0 A_ClearTarget
			Goto See
		Grow:
			"####" "#" 4 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(1.0*(user_scalex/65536.0),1.0*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("NinjaOrange", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERSPECIAL|SXF_TRANSFERPOINTERS|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 2 Thing_Remove(0)
			stop
		Squish:
			"####" "#" 0 A_GiveInventory("SquishToken", 1)
			"####" "#" 0 A_JumpIfInTargetInventory("DukeStomp", 1, 2)
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 2 
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 0 
			"####" "#" 2 A_Die("Squish")
			"####" "#" 0
			loop
		Death:
		XDeath:
		Death.Squish:
		XDeath.Squish:
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A 0 A_GiveInventory("MasterDeadToken", 1, AAPTR_Master)
			stop
		DukeStomp:
			"####" "#" 0 A_GiveToTarget("DukeStomp", 1)
			Goto Squish
	}
}

actor NinjaOrange_ShrinkEffect : NinjaOrange
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			NIOJ R 0
			NIOJ R 0 A_SetUserVar("user_scalex", scalex*65536.0)
			NIOJ R 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

Actor NinjaBodyFlyOrange : NinjaBodyFlyBrown
{
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 ThrustThing(angle*256/360+128, random(8,24), 0, 0)
			TNT1 A 0 ThrustThingZ(0, random(12,28), 0, 0)
			NIOJ U 3
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		SpawnLoop:
			NIOJ U 3 A_CheckFloor("Landed")
			Loop
		Death:
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
			NIOJ U 3 A_CheckFloor("Landed")
			Goto Death+1
		Landed:
		    NIOJ U 3
			TNT1 A 0 A_PlaySound("Body/Land", 6)
			NIOJ VW 3
			TNT1 A 0 A_PlaySound("Ninja/die")
			NIOJ X 3
			NIOJ Y -1
			Stop
	}
}

Actor NinjaGray : NinjaRed 
{
	Health 160
	AttackSound "Ninja/Uzi2"
	Obituary "%o was killed by a gray belt ninja."
	PainChance 96
	DropItem "SWGrayNinjaDropRandom", 178
	+BOSSDEATH
	+DONTRIP
	+FLOORCLIP
	+NOINFIGHTING
	+DONTHARMCLASS
	+DONTHARMSPECIES
	States
	{
	Spawn:
		NIGJ A 0
		NIGJ A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
		NIGJ A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		NIGJ A 0 A_GiveInventory("AlreadySpawned",1)
    Spawn2:
		TNT1 A 0 A_Jump(256,3)
		TNT1 A 0 A_Jump(184,2)
		TNT1 A 0 A_GiveInventory("CultistIsCrawling",1)	
		TNT1 A 0
	SpawnLoop:		
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"SpawnCrawl")		
		NIGJ A 10 A_Look
		Loop
	SpawnCrawl:
		NIGJ K 10 A_Look
		Loop
	See:
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"Crawling")			
	SeeLoop:	
		NIGJ AAA 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIGJ BBB 2 A_Chase
		NIGJ CCC 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIGJ DDD 2 A_Chase
		Loop
	Crawling:
		NIGJ KKK 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIGJ LLL 2 A_Chase
		NIGJ MMM 2 A_Chase("","",CHF_NOPLAYACTIVE)
		NIGJ NNN 2 A_Chase
		Loop	
	Missile:
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		TNT1 A 0 A_Jump(84, "PowerShot", "Shuriken")
		NIGJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIGJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIGJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIGJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIGJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NIGJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(4,6), "BulletPuffSW", 0, CBAF_NORANDOM)
		NIGJ E 4
		Goto See
	PowerShot:
		NIGJ AAA 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/grenade_launch",5)
		NIGJ E 4 A_CustomMissile("SWGrenadeWeak")
		NIGJ EE 4
		Goto See
	Shuriken:
		NIDB JJJ 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)
		NIDB K 4 A_CustomMissile("ShurikenShotNinja")
		NIDB L 4
		Goto See		
	Pain:
		NIGJ R 3
		NIGJ R 3 A_Pain
		TNT1 A 0 A_Jump(128, 2)
		TNT1 A 0 A_JumpIfHealthLower(50, "Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(180,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0				
		Goto See
	Pain.MightyBoot:
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
		NIGJ R 2 A_FaceTarget
		TNT1 A 0 A_Recoil(14)
		NIGJ R 16 A_Pain
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_JumpIfHealthLower(50,"Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0
		Goto See
	Pain.ZorchPistol:
	Pain.Zorch:
	Pain.ZorchKamikaze:
	Pain.PhasingZorch:
	Pain.ZorchSpectral:
		NIGJ R 3
		NIGJ R 3 A_Pain
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Choke:
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_PlaySound("Ninja/Choke")
		NIGB ABCBABC 5
		TNT1 A 0 A_Jump(96, "ChokeFinish")
		NIGB BABCBA 5
		TNT1 A 0 A_Jump(128, "ChokeFinish")
		NIGB BC 5
	ChokeFinish:
		NIGJ R 1 A_Die
		Wait
	Death:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)    
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")
		NIGJ R 4 A_StopSound(CHAN_BODY)		
		NIGJ S 3 A_Scream
		NIGJ T 3 A_NoBlocking
		NIGJ UVWX 3
		NIGJ Y 0 A_KillMaster
		NIGJ Y 0 A_SpawnItemEx("SWNinjaGrayCorpse_Normal", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop	
	Death.SWKatana:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  	
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_GiveInventory("SWEnemy_SwordDeath", 1)	
		TNT1 A 0 A_Stop
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(128, 1)
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		NIGC A 30 A_PlaySound("ninja/Cut",6)
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")	
		NIGC BCDEFGHI 5
		NIGC J 0 A_KillMaster
		NIGC J 0 A_SpawnItemEx("SWNinjaGrayCorpse_Sword", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop
	Death.SWFist:
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWFisted")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait	
	Death.SWShuriken:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWShurikend")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWSticky:
	Death.SWStickyCoop:		
	Death.SWGrenade:
	Death.SWNuke:
	Death.SWRocket:
	Death.SWRailgun:
	Death.SWRailgunCoop:
	Death.SWNukeCoop:
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
	Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWFlame:
	Death.SWFlame2:
	Death.SWFlame2Coop:
	Death.SWFlame3:	
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
		TNT1 A 0 A_Jump(218, "Burn")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Burn")
		wait
	XDeathForWang:
		TNT1 A 0 A_ChangeFlag("SOLID",false)
		TNT1 A 0 A_Jump(218, "XDeath")	
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt2",1)
		TNT1 A -1 A_Jump(256,"XDeath")
		wait		
    Death.CalebFire:
	Death.LifeLeech:
		TNT1 A 0 A_Jump(218, 2)
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		TNT1 A 0 A_SpawnItemEx("BloodBurningCorpse_Generic", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		TNT1 A 0 A_Stop
		TNT1 A 5 A_NoBlocking
		TNT1 A -1 ACS_NamedExecuteWithResult("SamsaraBossDeathToggler")
		Stop
	Pain.ShrinkerDMG:
		NIGJ R 0
		"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
		"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
		"####" "#" 0 A_ChangeFlag("NOPAIN", 1)
		"####" "#" 0 A_ChangeFlag("NODAMAGE", 1)
		"####" "#" 0 A_ChangeFlag("SOLID",false)
		"####" "#" 0 A_PlaySound("duke/shrink")
		"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
		"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaGray_Shrink", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERSPECIAL|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
		TNT1 A 2
		TNT1 A 0 A_ChangeFlag("COUNTKILL", 0)
		TNT1 A 0 A_ChangeFlag("NODAMAGE", 1)
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_ChangeFlag("VULNERABLE", 1)
		TNT1 A 0 A_ChangeFlag("SHOOTABLE", 0)
		Goto ShrunkLoop
	ShrunkLoop:
		TNT1 A 2 A_JumpIfInventory("MasterDeadToken",1,"ShrunkDie")
		loop
	ShrunkDie:
		TNT1 A 0
		TNT1 A 1 A_Die("Shrink")
		stop
	Death.Shrink:
		TNT1 A 0
		TNT1 A 1 A_KillMaster
		stop
    }
}

Actor SWGrayNinjaDropRandom : RandomSpawner
{
	DropItem "SWEnemy_UziMagDrop", 256, 5
	DropItem "SWEnemy_GrenadeDrop", 256, 3
}	

Actor SWNinjaGrayCorpse_Normal : SamsaraCorpseActor
{
	Health 40
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIGJ Y 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaGrayCorpse_Sword : SamsaraCorpseActor
{
	Health 40
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIGC J 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaGrayCorpse_Suicide : SamsaraCorpseActor
{
	Health 40
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIGS H 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

actor NinjaGray_Shrink : NinjaGray
{
	+FRIGHTENED
	+NOTRIGGER
	-SHOOTABLE
	+THRUACTORS
	+NORADIUSDMG
	+VULNERABLE
	+QUICKTORETALIATE
	+COUNTKILL
	-NOGRAVITY
	+NODAMAGE
	+NOPAIN
	MaxStepHeight 0
	MaxDropOffHeight 0
	MeleeRange 16
	Height 16
	Health 1
	Speed 1
	PainChance "ShrinkDMG", 0
	DamageFactor "ShrinkDMG", 0.0
	PainChance "ExpanderDMG", 0
	DamageFactor "ExpanderDMG", 0.0
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_JumpIfInventory("ShrunkToken",1,"SpawnLoop")
			TNT1 A 0 A_SetUserVar("user_scalex", scalex*65536.0)
			TNT1 A 0 A_SetUserVar("user_scaley", scaley*65536.0)
			TNT1 A 0 A_SetScale(scalex*0.2,scaley*0.2) // setting the scale in ACS does work, but the actor shows up at normal size for a split second
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_Shrinker", 0, 1)
			NIGJ R 10
			Goto See
		SpawnLoop:
			NIGJ A 5 A_Look
			Loop
		See:
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ A 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ B 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ C 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NIGJ D 2 A_Chase("","")
			"####" "#" 0 A_JumpIf(CallACS("Samsara_Shrinker", 3) == 0, "Forget")
			Loop
		Forget:
			"####" "#" 0 A_ClearTarget
			Goto See
		Grow:
			"####" "#" 4 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(1.0*(user_scalex/65536.0),1.0*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("NinjaGray", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERSPECIAL|SXF_TRANSFERPOINTERS|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 2 Thing_Remove(0)
			stop
		Squish:
			"####" "#" 0 A_GiveInventory("SquishToken", 1)
			"####" "#" 0 A_JumpIfInTargetInventory("DukeStomp", 1, 2)
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 2 
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 0 
			"####" "#" 2 A_Die("Squish")
			"####" "#" 0
			loop
		Death:
		XDeath:
		Death.Squish:
		XDeath.Squish:
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A 0 A_GiveInventory("MasterDeadToken", 1, AAPTR_Master)
			stop
		DukeStomp:
			"####" "#" 0 A_GiveToTarget("DukeStomp", 1)
			Goto Squish
	}
}

actor NinjaGray_ShrinkEffect : NinjaGray
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			NIGJ R 0
			NIGJ R 0 A_SetUserVar("user_scalex", scalex*65536.0)
			NIGJ R 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

Actor SWGrenadeWeak
{
	PROJECTILE
	-NOGRAVITY
	+HEXENBOUNCE
	+CANBOUNCEWATER
	+MOVEWITHSECTOR
    -BOUNCEONACTORS
	BounceCount 2
	BounceFactor 0.5
	Gravity 0.2
	SeeSound "sw/grenade_bounce"
	Speed 28
	Radius 7
	Height 12
	Damage (Random(15,30))
	scale 0.6
	Reactiontime 255
	DamageType ""
	states
	{
    Spawn:
        TNT1 A 0 NoDelay A_Recoil(-1) 
        TNT1 A 0 A_PlaySound("quakeweps/blank", CHAN_VOICE)
        goto SpawnLoop
 	SpawnLoop:
		SP20 A 0 A_CountDown
		SP20 A 1 A_SpawnItemEx("SWGrenadeSmoke",0,0,0,0,0,0,0,SXF_CLIENTSIDE)
		Loop
	Death:
		SP20 A 0 Radius_Quake(2,45,0,9,0)
		TNT1 A 0 A_Explode(70,60)
		SP20 A 0 A_PlaySound("sw/grenade_boom",CHAN_BODY)
		SP20 B 1 bright A_SpawnItemEx("SWGrenadeWeakBoom")
		SP20 CD 1 bright A_SpawnItemEx("SWGrenadeWeakMiniBoom",random(-30,30),random(-30,30))
		SP20 AAAAA 0 A_CustomMissile("SWGrenadeBall",0,0,random(0,360),CMF_TRACKOWNER|CMF_AIMDIRECTION,random(55,80))
		SP20 EF 1 bright A_SpawnItemEx("SWGrenadeWeakMiniBoom",random(-30,30),random(-30,30))
		TNT1 A 54
		stop
	}
}

Actor SWGrenadeWeakBoom
{
	+NOGRAVITY
	-SOLID
	scale 1.8
	DamageType "SWGrenade"
	states
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("sw/sticky_boom",CHAN_BODY)
		WMI9 A 2 bright A_Explode(16,128)
		WMI9 BCDEFGHIJKLMNOPQRSTUV 2 bright
		stop
	}
}

Actor SWGrenadeWeakMiniBoom : SWGrenadeBoom
{
	scale 0.75
	states
	{
	Spawn:
		TNT1 A 2
		WMI9 A 2 bright A_Explode(3,64)
		WMI9 BCDEFGHIJKLMNOPQRSTUV 2 bright
		stop
	}
}

Actor NinjaBodyFlyGray : NinjaBodyFlyBrown
{
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 ThrustThing(angle*256/360+128, random(8,24), 0, 0)
			TNT1 A 0 ThrustThingZ(0, random(12,28), 0, 0)
			NIGJ U 3
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		SpawnLoop:
			NIGJ U 3 A_CheckFloor("Landed")
			Loop
		Death:
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
			NIGJ U 3 A_CheckFloor("Landed")
			Goto Death+1
		Landed:
		    NIGJ U 3
			TNT1 A 0 A_PlaySound("Body/Land", 6)
			NIGJ VW 3
			TNT1 A 0 A_PlaySound("Ninja/die")
			NIGJ X 3
			NIGJ Y -1
			Stop
	}
}

Actor NinjaDark : NinjaRed 
{
	Tag "Shadow Ninja"
	Health 160
	Mass 160
	AttackSound "Ninja/Uzi2"
	Obituary "%o was killed by a dark ninja."
	PainChance 64
	Speed 12
	Alpha 0.65
	Renderstyle Stencil
	StencilColor "Black"
	DropItem "SWDarkNinjaDropRandom"
	+BOSSDEATH
	+DONTRIP
	+FLOORCLIP
	+NOINFIGHTING
	+DONTHARMCLASS
	+DONTHARMSPECIES
	States
	{
	Spawn:
		NINJ A 0
		NINJ A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
		NINJ A 1 ACS_NamedExecuteAlways("ReMixerSpawnScript",0,1,0)
		NINJ A 0 A_GiveInventory("AlreadySpawned",1)
    Spawn2:
		TNT1 A 0 A_Jump(256,3)
		TNT1 A 0 A_Jump(184,2)
		TNT1 A 0 A_GiveInventory("CultistIsCrawling",1)	
		TNT1 A 0
	SpawnLoop:		
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"SpawnCrawl")			
		NINJ A 10 A_Look
		Loop
	SpawnCrawl:
		NINJ K 10 A_Look
		Loop
	See:
		TNT1 A 0 A_JumpIfInventory("CultistIsCrawling",1,"Crawling")
	SeeLoop:	
		NINJ AAAAA 1 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ BBBBB 1 A_Chase
		NINJ CCCCC 1 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ DDDDD 1 A_Chase
		Loop
	Crawling:
		NINJ KKKKK 1 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ LLLLL 1 A_Chase
		NINJ MMMMM 1 A_Chase("","",CHF_NOPLAYACTIVE)
		NINJ NNNNN 1 A_Chase
		Loop	
	Missile:
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		TNT1 A 0 A_Jump(128, "PowerShot")
		NINJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NINJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(6,8), "BulletPuffSW", 0, CBAF_NORANDOM)
		NINJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NINJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(6,8), "BulletPuffSW", 0, CBAF_NORANDOM)
		NINJ E 4 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("SWBulletCasingSpawner",cos(-pitch)*30,15,28+sin(-pitch)*30)		
		NINJ F 4 Bright A_CustomBulletAttack(4.8, 3.2, 1, random(6,8), "BulletPuffSW", 0, CBAF_NORANDOM)
		NINJ E 4		
		Goto See
	PowerShot:
		TNT1 A 0 A_Jump(128, "Flash", "Pillar", "Shuriken")
	Spread:
		NINJ OO 4 A_FaceTarget
		NINJ P 5 A_CustomMissile("DarkNinjaSpread")
		NINJ QQ 5
		Goto See
	Pillar:
		NINJ OO 4 A_FaceTarget
		NINJ P 5 A_SpawnItem("DarkNinjaFlamePillarSpawner", 6)
		NINJ QQ 5
		Goto See
	Flash:
		TNT1 A 0 A_JumpIfCloser(384, "Success")
		Goto Spread
	Success:
		TNT1 A 0 A_PlaySound("SW/DarkNinja/FlashBomb",6)
		TNT1 A 0 A_GiveToTarget("DarkNinjaFlashBlindEffect")		
		NINJ A 16 A_CustomMissile("DarkNinjaFlash")
		Goto See
	Shuriken:
		NINJ OOO 4 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)	
		NINJ P 4 A_CustomMissile("ShurikenShotNinja")
		NINJ Q 2 A_FaceTarget
		NINJ O 2 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)	
		NINJ P 4 A_CustomMissile("ShurikenShotNinja")
		NINJ Q 2 A_FaceTarget
		NINJ O 2 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)	
		NINJ P 4 A_CustomMissile("ShurikenShotNinja")
		NINJ Q 2 A_FaceTarget
		NINJ O 2 A_FaceTarget
		TNT1 A 0 A_PlaySound("sw/swing",CHAN_WEAPON)	
		NINJ P 4 A_CustomMissile("ShurikenShotNinja")
		NINJ Q 4
		Goto See		
	Pain:
		NINJ R 3
		NINJ R 3 A_Pain
		TNT1 A 0 A_Jump(128, 2)
		TNT1 A 0 A_JumpIfHealthLower(50, "Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(180,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0
		Goto See
	Pain.MightyBoot:
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
		NINJ R 2 A_FaceTarget
		TNT1 A 0 A_Recoil(14)
		NINJ R 16 A_Pain
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_JumpIfHealthLower(50,"Choke")
		TNT1 A 0
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0
		Goto See
	Pain.ZorchPistol:
	Pain.Zorch:
	Pain.ZorchKamikaze:
	Pain.PhasingZorch:
	Pain.ZorchSpectral:
		NINJ R 3
		NINJ R 3 A_Pain
		TNT1 A 0 A_Jump(246,2)
		TNT1 A 0 A_TakeInventory("CultistIsCrawling",1)
		TNT1 A 0		
		Goto See
	Choke:
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_SetTranslucent(1.0, 0)
		TNT1 A 0 A_PlaySound("Ninja/Choke")
		NIDB ABCBABC 5
		TNT1 A 0 A_Jump(96, "ChokeFinish")
		NIDB BABCBA 5
		TNT1 A 0 A_Jump(128, "ChokeFinish")
		NIDB BC 5
	ChokeFinish:
		NIDJ R 1 A_Die
		Wait
	Death:
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")
		TNT1 A 0 A_SetTranslucent(1.0, 0)
		NIDJ R 4 A_StopSound(CHAN_BODY)		
		NIDJ S 3 A_Scream
		NIDJ T 3 A_NoBlocking
		NIDJ UVWX 3
		NIDJ Y 0 A_KillMaster
		NIDJ Y 0 A_SpawnItemEx("SWNinjaDarkCorpse_Normal", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop	
	Death.SWKatana:
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)  	
		TNT1 A 0 A_SetTranslucent(1.0, 0)	
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_GiveInventory("SWEnemy_SwordDeath", 1)		
		TNT1 A 0 A_Stop
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(128, 1)
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A 0
		NIDC A 30 A_PlaySound("ninja/Cut",6)
		TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")	
		NIDC BCDEFGHI 5
		NIDC J 0 A_KillMaster
		NIDC J 0 A_SpawnItemEx("SWNinjaDarkCorpse_Sword", 0, 0, 0, velx, vely, velz, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERSCALE|SXF_ABSOLUTEVELOCITY)
		TNT1 A -1
		stop	
	Death.SWFist:
		TNT1 A 0 A_GiveToTarget("SWLoWangBloody", 1)
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWFisted")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait	
	Death.SWShuriken:
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_SpawnItemEx("SWShurikend")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWSticky:
	Death.SWStickyCoop:		
	Death.SWGrenade:
	Death.SWNuke:
	Death.SWRocket:
	Death.SWRailgun:
	Death.SWRailgunCoop:
	Death.SWNukeCoop:
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
	Death.SWBullet:	  
		TNT1 A 0 A_Jump(218, "Death")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Death")
		wait
	Death.SWFlame:
	Death.SWFlame2:
	Death.SWFlame2Coop:
	Death.SWFlame3:	
		TNT1 A 0 A_JumpIfHealthLower(-3,"XDeathForWang")
		TNT1 A 0 A_Jump(218, "Burn")
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt1", 1)
		TNT1 A -1 A_Jump(256,"Burn")
		wait
	XDeathForWang:
		TNT1 A 0 A_ChangeFlag("SOLID",false)
		TNT1 A 0 A_Jump(218, "XDeath")	
		TNT1 A 0 A_GiveToTarget("LoWangDMTaunt2",1)
		TNT1 A -1 A_Jump(256,"XDeath")
		wait
    Death.CalebFire:
	Death.LifeLeech:
		TNT1 A 0 A_Jump(218, 2)
		TNT1 A 0 A_GiveToTarget("CalebDMTaunt1", 1)
		TNT1 A 0 A_SpawnItemEx("BloodBurningCorpse_Generic", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
		TNT1 A 0 A_Stop
		TNT1 A 5 A_NoBlocking
		TNT1 A -1 ACS_NamedExecuteWithResult("SamsaraBossDeathToggler")
		Stop
	Pain.ShrinkerDMG:
		NINJ R 0
		"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
		"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
		"####" "#" 0 A_ChangeFlag("NOPAIN", 1)
		"####" "#" 0 A_ChangeFlag("NODAMAGE", 1)
		"####" "#" 0 A_ChangeFlag("SOLID",false)
		"####" "#" 0 A_PlaySound("duke/shrink")
		"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
		"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
		"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
		"####" "#" 0 A_SpawnItemEx("NinjaDark_Shrink", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERSPECIAL|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
		TNT1 A 2
		TNT1 A 0 A_ChangeFlag("NODAMAGE", 1)
		TNT1 A 0 A_ChangeFlag("NOPAIN", 1)
		TNT1 A 0 A_ChangeFlag("VULNERABLE", 1)
		TNT1 A 0 A_ChangeFlag("SHOOTABLE", 0)
		Goto ShrunkLoop
	ShrunkLoop:
		TNT1 A 2 A_JumpIfInventory("MasterDeadToken",1,"ShrunkDie")
		loop
	ShrunkDie:
		TNT1 A 0
		TNT1 A 1 A_Die("Shrink")
		stop
	Death.Shrink:
		TNT1 A 0
		TNT1 A 1 A_KillMaster
		stop
    }
}

Actor SWDarkNinjaDropRandom : RandomSpawner
{
	DropItem "SWEnemy_UziMagDrop", 256, 3
	DropItem "SWEnemy_SmokeBombDrop", 256, 6
}	

Actor SWNinjaDarkCorpse_Normal : SamsaraCorpseActor
{
	Health 45
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIDJ Y 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaDarkCorpse_Sword : SamsaraCorpseActor
{
	Health 45
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIDC J 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

Actor SWNinjaDarkCorpse_Suicide : SamsaraCorpseActor
{
	Health 45
	Height 8
	Radius 16
	Mass 5000
	BloodType "SWDefaultBloodSpawner"
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	-SOLID
	+NOTARGET
	-FRIENDLY
	+NOBLOODDECALS
	States
	{
		Spawn:
			NIDS H 4
			Loop
		Death:
			TNT1 A 0 A_RemoveMaster
			TNT1 A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			TNT1 A 0 A_ChangeFlag("SOLID",false)
			TNT1 A 0 A_NoBlocking
			TNT1 A 0 A_PlaySound("sw/gib_land1",CHAN_BODY)
			TNT1 AAAAAAA 0 A_SpawnItemEx("SWBlood",random(-12,12),random(-12,12),random(0,40),random(-5,5),random(-5,5),random(4,10),0,SXF_USEBLOODCOLOR|SXF_TRANSFERTRANSLATION)
			stop
	}
}

actor NinjaDark_Shrink : NinjaDark
{
	+FRIGHTENED
	+NOTRIGGER
	-SHOOTABLE
	+THRUACTORS
	+NORADIUSDMG
	+VULNERABLE
	+QUICKTORETALIATE
	-COUNTKILL
	-NOGRAVITY
	+NODAMAGE
	+NOPAIN
	MaxStepHeight 0
	MaxDropOffHeight 0
	MeleeRange 16
	Height 16
	Health 1
	Speed 1
	PainChance "ShrinkDMG", 0
	DamageFactor "ShrinkDMG", 0.0
	PainChance "ExpanderDMG", 0
	DamageFactor "ExpanderDMG", 0.0
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_JumpIfInventory("ShrunkToken",1,"SpawnLoop")
			TNT1 A 0 A_SetUserVar("user_scalex", scalex*65536.0)
			TNT1 A 0 A_SetUserVar("user_scaley", scaley*65536.0)
			TNT1 A 0 A_SetScale(scalex*0.2,scaley*0.2) // setting the scale in ACS does work, but the actor shows up at normal size for a split second
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_Shrinker", 0, 1)
			NINJ R 10
			Goto See
		SpawnLoop:
			NINJ A 5 A_Look
			Loop
		See:
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ A 1 A_Chase("","")			
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ B 1 A_Chase("","")			
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ C 1 A_Chase("","")			
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 1 A_Chase("","")
			"####" "#" 0 A_JumpIfInTargetInventory("ChexClass", 1, 5) // this is supposed to be child friendly
			"####" "#" 0 A_JumpIfInTargetInventory("DukeClass", 1, 3)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("Squish")
			"####" "#" 0 A_Jump(256, 2)
			"####" "#" 0 A_JumpIfTargetInSideMeleeRange("DukeStomp")
			NINJ D 1 A_Chase("","")			
			"####" "#" 0 A_JumpIf(CallACS("Samsara_Shrinker", 3) == 0, "Forget")
			Loop
		Forget:
			"####" "#" 0 A_ClearTarget
			Goto See
		Grow:
			"####" "#" 4 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(1.0*(user_scalex/65536.0),1.0*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("NinjaDark", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_TRANSFERSPECIAL|SXF_TRANSFERPOINTERS|SXF_TRANSFERAMBUSHFLAG|SXF_SETMASTER,0,tid)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 0 A_GiveToChildren("ShrunkPropertyTransfer",1)
			TNT1 A 2 Thing_Remove(0)
			stop
		Squish:
			"####" "#" 0 A_GiveInventory("SquishToken", 1)
			"####" "#" 0 A_JumpIfInTargetInventory("DukeStomp", 1, 2)
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 2 
			"####" "#" 0 A_Jump(256,3)
			"####" "#" 0 
			"####" "#" 2 A_Die("Squish")
			"####" "#" 0
			loop
		Death:
		XDeath:
		Death.Squish:
		XDeath.Squish:
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A 0 A_GiveInventory("MasterDeadToken", 1, AAPTR_Master)
			stop
		DukeStomp:
			"####" "#" 0 A_GiveToTarget("DukeStomp", 1)
			Goto Squish
	}
}

actor NinjaDark_ShrinkEffect : NinjaDark
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
//	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			NINJ R 0
			NINJ R 0 A_SetUserVar("user_scalex", scalex*65536.0)
			NINJ R 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

Actor NinjaBodyFlyDark : NinjaBodyFlyBrown
{
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 ThrustThing(angle*256/360+128, random(8,24), 0, 0)
			TNT1 A 0 ThrustThingZ(0, random(12,28), 0, 0)
			NIDJ U 3
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		SpawnLoop:
			NIDJ U 3 A_CheckFloor("Landed")
			Loop
		Death:
			TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
			NIDJ U 3 A_CheckFloor("Landed")
			Goto Death+1
		Landed:
		    NIDJ U 3
			TNT1 A 0 A_PlaySound("Body/Land", 6)
			NIDJ VW 3
			TNT1 A 0 A_PlaySound("Ninja/die")
			NIDJ X 3
			NIDJ Y -1
			Stop
	}
}

Actor DarkNinjaSpread
{
	PROJECTILE
	Damage (0)
	Speed 28
	Radius 9
	Height 10
	Scale 0.8
	RenderStyle Translucent
	Alpha 0.67
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_PlaySound("SW/DarkNinja/FireBall/Loop",5,1.0,1,ATTN_NORM)
		SpawnLoop:	
			WP70 AA 2 Bright
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 90, CMF_AIMDIRECTION | CMF_TRACKOWNER)
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 270, CMF_AIMDIRECTION | CMF_TRACKOWNER)
			WP70 BB 2 Bright
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 90, CMF_AIMDIRECTION | CMF_TRACKOWNER)
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 270, CMF_AIMDIRECTION | CMF_TRACKOWNER)			
			WP70 CC 2 Bright
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 90, CMF_AIMDIRECTION | CMF_TRACKOWNER)
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 270, CMF_AIMDIRECTION | CMF_TRACKOWNER)			
			WP70 DD 2 Bright
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 90, CMF_AIMDIRECTION | CMF_TRACKOWNER)
			TNT1 A 0 A_CustomMissile("DarkNinjaSpread2", 0, 0, 270, CMF_AIMDIRECTION | CMF_TRACKOWNER)			
			Loop
		Death:
			TNT1 A 0 A_Explode(Random(100,150), 256)
			TNT1 A 0 A_StopSound(5)
			TNT1 A 0 A_PlaySound("Weapons/MissileHitX")
			DNIN EFGHI 5 Bright
			Stop
	}
}

Actor DarkNinjaSpread2 : DarkNinjaSpread
{
	Speed 32
	Xscale 0.8
	YScale 0.6
	States
	{
		Spawn:
			DNIN ABCD 6 Bright
			Loop
	}
}

Actor DarkNinjaFlamePillarSpawner : FlamePillarSpawner
{	
    DamageType ""
	States
	{
		Spawn:
		    TNT1 A 0
			TNT1 A 0 A_CustomMissile("DarkNinjaPillar", 0, -32, 0, CMF_AIMDIRECTION | CMF_TRACKOWNER, 0)
			TNT1 A 0 A_CustomMissile("DarkNinjaPillar", 0, 32, 0, CMF_AIMDIRECTION | CMF_TRACKOWNER, 0)
			Stop
	}
}

Actor DarkNinjaPillar : PillarOfFlame
{
    DamageType ""
	Speed 32
	Damage (Random(25,50))
	Scale 0.55
	States
	{
		Spawn:
			GHEP EF 3 Bright A_SpawnItem("PillarTinyTrail")
			TNT1 A 0 A_Explode(Random(30,45), 84, 0)
			TNT1 A 0 A_PlaySound("Weapons/FlamePillar")
			TNT1 A 0 A_SpawnItem("DarkNinjaPillarTrail")
			GHEP GH 3 Bright A_SpawnItem("PillarTinyTrail")
			TNT1 A 0 A_Explode(Random(30,45), 84, 0)
			TNT1 A 0 A_PlaySound("Weapons/FlamePillar")
			TNT1 A 0 A_SpawnItem("DarkNinjaPillarTrail")
			Loop
	}
}

Actor DarkNinjaPillarTrail : PillarTrail
{
	Scale 0.55
	+CLIENTSIDEONLY
	States
	{
		Spawn:
			WMI3 ABCDEFGH 2 bright
			WMI3 IJKLMNOP 2 bright
			WMI3 QRSTUV 2 bright
			Stop
	}
}

Actor DarkNinjaFlash
{
	PROJECTILE
	Damage 0
	Radius 2
	Height 2
	DamageType "DarkNinjaFlash"
	+RIPPER
	+BLOODLESSIMPACT
	States
	{
		Spawn:
			TNT1 A 1
			TNT1 A 0 A_Explode(1, 448, 0)
			TNT1 A 1
			Stop
	}
}

Actor Suicided : Inventory { inventory.maxamount 1 }

ACTOR DarkNinjaFlashBlindEffect : CustomInventory
{
    Inventory.MaxAmount 0
    +AUTOACTIVATE
    States
    {
    Spawn:
        TNT1 A 0
        stop
    Pickup:
        TNT1 A 0
        TNT1 A 0 A_SetBlend("fdffc3",1,120)
        stop
    UseStop:
        TNT1 A 0
        stop
    }
}